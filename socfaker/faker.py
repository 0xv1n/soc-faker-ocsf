nessus_plugin_samples = ['{"description": "Updated XFree86 packages that fix a security issue are now available for Red Hat Enterprise Linux 2.1 and 3.\\n\\nThis update has been rated as having important security impact by the Red Hat Security Response Team.\\n\\nXFree86 is an implementation of the X Window System, which provides the core functionality for the Linux graphical desktop.\\n\\nAn integer overflow flaw in the way the XFree86 server processes PCF files was discovered. A malicious authorized client could exploit this issue to cause a denial of service (crash) or potentially execute arbitrary code with root privileges on the XFree86 server.\\n(CVE-2006-3467)\\n\\nUsers of XFree86 should upgrade to these updated packages, which contain a backported patch and is not vulnerable to this issue.", "cvss3_base_score": "", "see_also": "https://access.redhat.com/security/cve/cve-2006-3467\\nhttps://access.redhat.com/errata/RHSA-2006:0635", "cvss3_vector": "", "published_date": "", "solution": "Update the affected packages.", "script_name": "RHEL 2.1 / 3 : XFree86 (RHSA-2006:0635)", "synopsis": "The remote Red Hat host is missing one or more security updates.", "risk_factor": "High", "script_family": "Red Hat Local Security Checks", "script_id": "22266", "cves": "CVE-2006-3467"}',
 '{"description": "The remote host is running a version of the AnalogX SimpleServer web server that is affected by a directory traversal vulnerability.  An attacker could exploit this in order to read arbitrary files in the context of the affected server.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "2000/07/26", "solution": "Upgrade to SimpleServer 1.07 or later.", "script_name": "AnalogX SimpleServer:WWW Encoded Traversal Arbitrary File Access", "synopsis": "The remote web server is vulnerable to a directory traversal.", "risk_factor": "Medium", "script_family": "Web Servers", "script_id": "10489", "cves": "CVE-2000-0664"}',
 '{"description": "This update for glib2 fixes the following issues :\\n\\nSecurity issues fixed :\\n\\n  - CVE-2018-16428: Do not do a NULL pointer dereference     (crash). Avoid that, at the cost of introducing a new     translatable error message (bsc#1107121).\\n\\n  - CVE-2018-16429: Fixed out-of-bounds read vulnerability     ing_markup_parse_context_parse() (bsc#1107116).\\n\\nNon-security issue fixed :\\n\\n  - various GVariant parsing issues have been resolved     (bsc#1111499)\\n\\nThis update was imported from the SUSE:SLE-15:Update update project.", "cvss3_base_score": "9.8", "see_also": "https://bugzilla.opensuse.org/show_bug.cgi?id=1107116\\nhttps://bugzilla.opensuse.org/show_bug.cgi?id=1107121\\nhttps://bugzilla.opensuse.org/show_bug.cgi?id=1111499", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "published_date": "", "solution": "Update the affected glib2 packages.", "script_name": "openSUSE Security Update : glib2 (openSUSE-2018-1485)", "synopsis": "The remote openSUSE host is missing a security update.", "risk_factor": "High", "script_family": "SuSE Local Security Checks", "script_id": "119493", "cves": ["CVE-2018-16428", "CVE-2018-16429"]}',
 '{"description": "This update fixes several minor issues with rpmdrake:\\n\\n- it stops running with debuging perl pragmas, which should speed up some things - it makes edit-urpm-sources not drop the \'ignore\' flag when updating a medium (bug #44930) - it makes edit-urpm-sources display the right type of altered mirrorlist media (bug #44930) - it makes rpmdrake list plasma applets in GUI package list too (bug #45835)\\n\\nIt also enhances searching in rpmdrake by fixing a rare crash on searching (bug #46225), by scrolling the group list to the search category when displaying results, and by updating the GUI package list.", "cvss3_base_score": "", "see_also": "http://www.mandriva.com/security/advisories?name=MDVA-2009:004", "cvss3_vector": "", "published_date": "", "solution": "Update the affected package(s).", "script_name": "MDVA-2009:004 : rpmdrake", "synopsis": "The remote Mandriva host is missing one or more security-related patches.", "risk_factor": "High", "script_family": "Mandriva Local Security Checks", "script_id": "38096", "cves": ""}',
 '{"description": "This update for tiff fixes the following issues :\\n\\n  - CVE-2016-3623: A divide by zero was fixed in the     rgb2ycbcr tool. (bsc#974618)\\n\\n  - CVE-2016-3945: An out-of-bounds write was fixed in the     tiff2rgba tool. (bsc#974614)\\n\\n  - CVE-2016-3990: An out-of-bounds write in     horizontalDifference8() in tiffcp tool (bsc#975069)\\n\\n  - CVE-2016-3991: An out-of-bounds write in loadImage() in     tiffcrop tool (bsc#975070)", "cvss3_base_score": "7.8", "see_also": "https://bugzilla.opensuse.org/show_bug.cgi?id=974614\\nhttps://bugzilla.opensuse.org/show_bug.cgi?id=974618\\nhttps://bugzilla.opensuse.org/show_bug.cgi?id=975069\\nhttps://bugzilla.opensuse.org/show_bug.cgi?id=975070", "cvss3_vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "published_date": "", "solution": "Update the affected tiff packages.", "script_name": "openSUSE Security Update : tiff (openSUSE-2016-1069)", "synopsis": "The remote openSUSE host is missing a security update.", "risk_factor": "Medium", "script_family": "SuSE Local Security Checks", "script_id": "93432", "cves": ["CVE-2016-3623", "CVE-2016-3945", "CVE-2016-3990", "CVE-2016-3991"]}',
 '{"description": "The remote host is missing AIX PTF U838614 which is related to the security of the package bos.rte.security\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 610004 : U838614", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "50272", "cves": ""}',
 '{"description": "The remote host is missing AIX PTF U815301 which is related to the security of the package devices.pci.1410bd02.diag\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 610000 : U815301", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "31234", "cves": ""}',
 '{"description": "Due to a flaw in Microsoft\'s SMB implementation, the remote host is vulnerable to a denial of service attack.  By sending a specially crafted packet request, an attacker could launch a denial of service, causing the affected host to crash.\\n\\nNote that this vulnerability is not exploitable without credentials unless anonymous access has been disabled.", "cvss3_base_score": "7.5", "see_also": "https://docs.microsoft.com/en-us/security-updates/SecurityBulletins/2002/ms02-045", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "published_date": "2002/08/22", "solution": "Microsoft has released a set of patches for Windows NT, 2000 and XP.", "script_name": "MS02-045: Unchecked buffer in Network Share Provider (326830)", "synopsis": "It is possible to crash the remote host.", "risk_factor": "High", "script_family": "Windows : Microsoft Bulletins", "script_id": "11300", "cves": "CVE-2002-0724"}',
 '{"description": "s700_800 11.04 (VVOS) cumulative ARPA Transport patch : \\n\\nA potential vulnerability has been identified in the HP-UX ARPA Transport which could be exploited by a local user to create a Denial of Service (DoS).", "cvss3_base_score": "", "see_also": "http://www.nessus.org/u?52650ec1", "cvss3_vector": "", "published_date": "", "solution": "Install patch PHNE_30905 or subsequent.", "script_name": "HP-UX PHNE_30905 : HP-UX Running ARPA Transport, Local Denial of Service (DoS) (HPSBUX01054 SSRT3552 rev.2)", "synopsis": "The remote HP-UX host is missing a security-related patch.", "risk_factor": "Medium", "script_family": "HP-UX Local Security Checks", "script_id": "16590", "cves": "CVE-2004-2665"}',
 '{"description": "Updated kernel packages that fix three security issues and multiple bugs are now available for Red Hat Enterprise Linux 5.3 Extended Update Support.\\n\\nThe Red Hat Security Response Team has rated this update as having important security impact. Common Vulnerability Scoring System (CVSS) base scores, which give detailed severity ratings, are available for each vulnerability from the CVE links in the References section.\\n\\nThe kernel packages contain the Linux kernel, the core of any Linux operating system.\\n\\nThis update fixes the following security issues :\\n\\n* a deficiency was found in the fasync_helper() implementation. This could allow a local, unprivileged user to leverage a use-after-free of locked, asynchronous file descriptors to cause a denial of service or privilege escalation. (CVE-2009-4141, Important)\\n\\n* a NULL pointer dereference flaw was found in the sctp_rcv_ootb() function in the Linux kernel Stream Control Transmission Protocol (SCTP) implementation. A remote attacker could send a specially crafted SCTP packet to a target system, resulting in a denial of service. (CVE-2010-0008, Important)\\n\\n* a NULL pointer dereference flaw was found in the ip6_dst_lookup_tail() function in the Linux kernel. An attacker on the local network could trigger this flaw by sending IPv6 traffic to a target system, leading to a system crash (kernel OOPS) if dst->neighbour is NULL on the target system when receiving an IPv6 packet. (CVE-2010-0437, Important)\\n\\nThis update also fixes the following bugs :\\n\\n* programs compiled on x86, and that also call sched_rr_get_interval(), were silently corrupted when run on 64-bit systems. With this update, when such programs attempt to call sched_rr_get_interval() on 64-bit systems, sys32_sched_rr_get_interval() is called instead, which resolves this issue. (BZ#557683)\\n\\n* the fix for CVE-2009-4538 provided by RHSA-2010:0053 introduced a regression, preventing Wake on LAN (WoL) working for network devices using the Intel PRO/1000 Linux driver, e1000e. Attempting to configure WoL for such devices resulted in the following error, even when configuring valid options :\\n\\n\'Cannot set new wake-on-lan settings: Operation not supported not setting wol\'\\n\\nThis update resolves this regression, and WoL now works as expected for network devices using the e1000e driver. (BZ#559334)\\n\\n* a number of bugs have been fixed in the copy_user routines for Intel 64 and AMD64 systems, one of which could have possibly led to data corruption. (BZ#568307)\\n\\n* on some systems, a race condition in the inode-based file event notifications implementation caused soft lockups and the following messages :\\n\\n\'BUG: warning at fs/inotify.c:181/set_dentry_child_flags()\' \'BUG: soft lockup - CPU#[x] stuck for 10s!\'\\n\\nThis update resolves this race condition, and also removes the inotify debugging code from the kernel, due to race conditions in that code.\\n(BZ#568663)\\n\\nUsers should upgrade to these updated packages, which contain backported patches to correct these issues. The system must be rebooted for this update to take effect.", "cvss3_base_score": "", "see_also": "https://www.redhat.com/security/data/cve/CVE-2009-4141.html\\nhttps://www.redhat.com/security/data/cve/CVE-2010-0008.html\\nhttps://www.redhat.com/security/data/cve/CVE-2010-0437.html\\nhttp://rhn.redhat.com/errata/RHSA-2010-0149.html", "cvss3_vector": "", "published_date": "", "solution": "Update the affected packages.", "script_name": "RHEL 5 : kernel (RHSA-2010:0149)", "synopsis": "The remote Red Hat host is missing one or more security updates.", "risk_factor": "High", "script_family": "Red Hat Local Security Checks", "script_id": "63922", "cves": ["CVE-2009-4141", "CVE-2010-0008", "CVE-2010-0437"]}',
 '{"description": "The Berkeley Internet Name Domain (BIND) is an implementation of the Domain Name System (DNS) protocols. BIND includes a DNS server (named); a resolver library (routines for applications to use when interfacing with DNS); and tools for verifying that the DNS server is operating correctly.\\n\\nA flaw was found in the way BIND handled resource records with a large RDATA value. A malicious owner of a DNS domain could use this flaw to create specially crafted DNS resource records, that would cause a recursive resolver or secondary server to exit unexpectedly with an assertion failure. (CVE-2012-4244)\\n\\nThis update also fixes the following bug :\\n\\n  - The bind-chroot-admin script, executed when upgrading     the bind-chroot package, failed to correctly update the     permissions of the /var/named/chroot/etc/named.conf     file. Depending on the permissions of the file, this     could have prevented named from starting after     installing package updates. With this update,     bind-chroot-admin correctly updates the permissions and     ownership of the file. Users of bind are advised to     upgrade to these updated packages, which correct these     issues. After installing the update, the BIND daemon     (named) will be restarted automatically.", "cvss3_base_score": "", "see_also": "http://www.nessus.org/u?c97ce2d1", "cvss3_vector": "", "published_date": "", "solution": "Update the affected packages.", "script_name": "Scientific Linux Security Update : bind on SL5.x i386/x86_64", "synopsis": "The remote Scientific Linux host is missing one or more security updates.", "risk_factor": "High", "script_family": "Scientific Linux Local Security Checks", "script_id": "62172", "cves": "CVE-2012-4244"}',
 '{"description": "An updated mutt package that fixes several security bugs is now available for Red Hat Enterprise Linux 3, 4 and 5.\\n\\nThis update has been rated as having moderate security impact by the Red Hat Security Response Team.\\n\\nMutt is a text-mode mail user agent.\\n\\nA flaw was found in the way Mutt used temporary files on NFS file systems. Due to an implementation issue in the NFS protocol, Mutt was not able to exclusively open a new file. A local attacker could conduct a time-dependent attack and possibly gain access to e-mail attachments opened by a victim. (CVE-2006-5297)\\n\\nA flaw was found in the way Mutt processed certain APOP authentication requests. By sending certain responses when mutt attempted to authenticate against an APOP server, a remote attacker could potentially acquire certain portions of a user\'s authentication credentials. (CVE-2007-1558)\\n\\nA flaw was found in the way Mutt handled certain characters in gecos fields which could lead to a buffer overflow. The gecos field is an entry in the password database typically used to record general information about the user. A local attacker could give themselves a carefully crafted \'Real Name\' which could execute arbitrary code if a victim uses Mutt and expands the attackers alias. (CVE-2007-2683)\\n\\nAll users of mutt should upgrade to this updated package, which contains a backported patches to correct these issues.", "cvss3_base_score": "", "see_also": "http://www.nessus.org/u?dd0b0883\\nhttp://www.nessus.org/u?9936db1e\\nhttp://www.nessus.org/u?5cb89483\\nhttp://www.nessus.org/u?51345981\\nhttp://www.nessus.org/u?bb361ced\\nhttp://www.nessus.org/u?cfe13dce\\nhttp://www.nessus.org/u?74e7828b\\nhttp://www.nessus.org/u?8e015e59", "cvss3_vector": "", "published_date": "", "solution": "Update the affected mutt package.", "script_name": "CentOS 3 / 4 / 5 : mutt (CESA-2007:0386)", "synopsis": "The remote CentOS host is missing a security update.", "risk_factor": "Low", "script_family": "CentOS Local Security Checks", "script_id": "25403", "cves": ["CVE-2006-5297", "CVE-2007-1558", "CVE-2007-2683"]}',
 '{"description": "The remote host is missing AIX PTF U833198 which is related to the security of the package devices.common.IBM.atm.rte.7.1.0.1\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 710000 : U833198", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "52118", "cves": ""}',
 '{"description": "The remote host is running a Veritas Scheduler Service.  Symantec Storage Foundation for Windows is a commercial storage and volume management solution from Symantec, and the Scheduler Service is used to schedule backup jobs.", "cvss3_base_score": "", "see_also": "http://www.nessus.org/u?ed8ee243", "cvss3_vector": "", "published_date": "", "solution": "n/a", "script_name": "Symantec Storage Foundation Scheduler Service Detection", "synopsis": "A Veritas Scheduler Service is listening on the remote host.", "risk_factor": "None", "script_family": "Service detection", "script_id": "31861", "cves": ""}',
 '{"description": "The remote OracleVM system is missing necessary patches to address critical security updates : please see Oracle VM Security Advisory OVMSA-2017-0057 for details.", "cvss3_base_score": "9.8", "see_also": "http://www.nessus.org/u?bc2355e2", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "published_date": "", "solution": "Update the affected kernel-uek / kernel-uek-firmware packages.", "script_name": "OracleVM 3.3 : Unbreakable / etc (OVMSA-2017-0057) (Dirty COW)", "synopsis": "The remote OracleVM host is missing one or more security updates.", "risk_factor": "Critical", "script_family": "OracleVM Local Security Checks", "script_id": "99163", "cves": ["CVE-2013-0343", "CVE-2013-1059", "CVE-2013-2140", "CVE-2013-2147", "CVE-2013-2148", "CVE-2013-2164", "CVE-2013-2234", "CVE-2013-2237", "CVE-2013-2850", "CVE-2013-2851", "CVE-2013-2852", "CVE-2013-2888", "CVE-2013-2889", "CVE-2013-2892", "CVE-2013-2893", "CVE-2013-2895", "CVE-2013-2896", "CVE-2013-2897", "CVE-2013-2898", "CVE-2013-2899", "CVE-2013-2929", "CVE-2013-2930", "CVE-2013-4162", "CVE-2013-4163", "CVE-2013-4299", "CVE-2013-4312", "CVE-2013-4345", "CVE-2013-4348", "CVE-2013-4350", "CVE-2013-4470", "CVE-2013-4579", "CVE-2013-4587", "CVE-2013-4592", "CVE-2013-6367", "CVE-2013-6368", "CVE-2013-6376", "CVE-2013-6383", "CVE-2013-6885", "CVE-2013-7263", "CVE-2013-7265", "CVE-2013-7266", "CVE-2013-7421", "CVE-2013-7446", "CVE-2014-0038", "CVE-2014-0049", "CVE-2014-0055", "CVE-2014-0069", "CVE-2014-0077", "CVE-2014-0101", "CVE-2014-0181", "CVE-2014-0196", "CVE-2014-1690", "CVE-2014-1737", "CVE-2014-1738", "CVE-2014-1739", "CVE-2014-2309", "CVE-2014-2523", "CVE-2014-2851", "CVE-2014-3144", "CVE-2014-3145", "CVE-2014-3153", "CVE-2014-3181", "CVE-2014-3182", "CVE-2014-3184", "CVE-2014-3185", "CVE-2014-3186", "CVE-2014-3215", "CVE-2014-3535", "CVE-2014-3601", "CVE-2014-3610", "CVE-2014-3611", "CVE-2014-3645", "CVE-2014-3646", "CVE-2014-3673", "CVE-2014-3687", "CVE-2014-3688", "CVE-2014-4014", "CVE-2014-4027", "CVE-2014-4171", "CVE-2014-4652", "CVE-2014-4653", "CVE-2014-4654", "CVE-2014-4655", "CVE-2014-4656", "CVE-2014-4667", "CVE-2014-4699", "CVE-2014-4943", "CVE-2014-5471", "CVE-2014-5472", "CVE-2014-6410", "CVE-2014-7822", "CVE-2014-7826", "CVE-2014-7970", "CVE-2014-7975", "CVE-2014-8133", "CVE-2014-8134", "CVE-2014-8159", "CVE-2014-8160", "CVE-2014-8171", "CVE-2014-8173", "CVE-2014-8884", "CVE-2014-8989", "CVE-2014-9090", "CVE-2014-9322", "CVE-2014-9529", "CVE-2014-9585", "CVE-2014-9644", "CVE-2015-0239", "CVE-2015-1333", "CVE-2015-1421", "CVE-2015-1593", "CVE-2015-1805", "CVE-2015-2150", "CVE-2015-2830", "CVE-2015-2922", "CVE-2015-3212", "CVE-2015-3339", "CVE-2015-3636", "CVE-2015-4700", "CVE-2015-5156", "CVE-2015-5157", "CVE-2015-5283", "CVE-2015-5307", "CVE-2015-5364", "CVE-2015-5366", "CVE-2015-5697", "CVE-2015-5707", "CVE-2015-6937", "CVE-2015-7613", "CVE-2015-7872", "CVE-2015-8104", "CVE-2015-8215", "CVE-2015-8374", "CVE-2015-8543", "CVE-2015-8569", "CVE-2015-8767", "CVE-2015-8956", "CVE-2016-0728", "CVE-2016-0758", "CVE-2016-0774", "CVE-2016-10088", "CVE-2016-10142", "CVE-2016-1583", "CVE-2016-2053", "CVE-2016-2117", "CVE-2016-3070", "CVE-2016-3134", "CVE-2016-3140", "CVE-2016-3157", "CVE-2016-3672", "CVE-2016-3699", "CVE-2016-4470", "CVE-2016-4482", "CVE-2016-4485", "CVE-2016-4565", "CVE-2016-4569", "CVE-2016-4578", "CVE-2016-4580", "CVE-2016-4997", "CVE-2016-4998", "CVE-2016-5195", "CVE-2016-5696", "CVE-2016-5829", "CVE-2016-6136", "CVE-2016-6327", "CVE-2016-6480", "CVE-2016-6828", "CVE-2016-7042", "CVE-2016-7117", "CVE-2016-7425", "CVE-2016-8399", "CVE-2016-8633", "CVE-2016-8645", "CVE-2016-8646", "CVE-2016-8650", "CVE-2016-8655", "CVE-2016-9178", "CVE-2016-9555", "CVE-2016-9588", "CVE-2016-9644", "CVE-2016-9793", "CVE-2016-9794", "CVE-2017-2636", "CVE-2017-5970", "CVE-2017-6074", "CVE-2017-6345", "CVE-2017-7187"]}',
 '{"description": "The remote host is using the WEBHANCER program. You should ensure that :\\n\\n  - the user intended to install WEBHANCER (it is sometimes     silently installed)\\n    - the use of WEBHANCER matches your corporate mandates     and security policies.\\n\\nTo remove this sort of software, you may wish to check out ad-aware or spybot.", "cvss3_base_score": "", "see_also": "http://www.ca.com/securityadvisor/pest/pest.aspx?id=43482", "cvss3_vector": "", "published_date": "", "solution": "Uninstall this software if it is not desired.", "script_name": "WEBHANCER Detection", "synopsis": "The remote software is potentially unwanted and considered spyware.", "risk_factor": "Medium", "script_family": "Windows", "script_id": "12005", "cves": ""}',
 '{"description": "According to its self-reported version number and configuration, the remote Juniper Junos device is affected by a denial of service vulnerability in the application layer gateway (ALG) that is triggered when matching in-transit traffic. An unauthenticated, remote attacker can exploit this to cause a denial of service.", "cvss3_base_score": "", "see_also": "https://kb.juniper.net/JSA10751", "cvss3_vector": "", "published_date": "2016/07/13", "solution": "Upgrade to the relevant Junos software release referenced in Juniper advisory JSA10751. Alternatively, disable all ALGs.", "script_name": "Juniper Junos SRX Series Application Layer Gateway DoS (JSA10751)", "synopsis": "The remote device is missing a vendor-supplied security patch.", "risk_factor": "High", "script_family": "Junos Local Security Checks", "script_id": "92519", "cves": "CVE-2016-1276"}',
 '{"description": "The remote host is missing AIX PTF U837526 which is related to the security of the package bos.perf.tools\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 530012 : U837526", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "49351", "cves": ""}',
 '{"description": "This update introduces the kde4 artwork for the upcoming Mandriva 2009 Spring Flash version.", "cvss3_base_score": "", "see_also": "http://www.mandriva.com/security/advisories?name=MDVA-2009:087", "cvss3_vector": "", "published_date": "", "solution": "Update the affected package(s).", "script_name": "MDVA-2009:087 : mandriva-kde4-config", "synopsis": "The remote Mandriva host is missing one or more security-related patches.", "risk_factor": "High", "script_family": "Mandriva Local Security Checks", "script_id": "47924", "cves": ""}',
 '{"description": "Updated glusterfs packages that fix multiple security issues, several bugs, and adds various enhancements are now available for Red Hat Gluster Storage 3.4 on Red Hat Enterprise Linux 6.\\n\\nRed Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.\\n\\nGlusterFS is a key building block of Red Hat Gluster Storage. It is based on a stackable user-space design and can deliver exceptional performance for diverse workloads. GlusterFS aggregates various storage servers over network interconnections into one large, parallel network file system.\\n\\nSecurity Fix(es) :\\n\\n* glusterfs: Unsanitized file names in debug/io-stats translator can allow remote attackers to execute arbitrary code (CVE-2018-10904)\\n\\n* glusterfs: Stack-based buffer overflow in server-rpc-fops.c allows remote attackers to execute arbitrary code (CVE-2018-10907)\\n\\n* glusterfs: I/O to arbitrary devices on storage server (CVE-2018-10923)\\n\\n* glusterfs: Device files can be created in arbitrary locations (CVE-2018-10926)\\n\\n* glusterfs: File status information leak and denial of service (CVE-2018-10927)\\n\\n* glusterfs: Improper resolution of symlinks allows for privilege escalation (CVE-2018-10928)\\n\\n* glusterfs: Arbitrary file creation on storage server allows for execution of arbitrary code (CVE-2018-10929)\\n\\n* glusterfs: Files can be renamed outside volume (CVE-2018-10930)\\n\\n* glusterfs: Improper deserialization in dict.c:dict_unserialize() can allow attackers to read arbitrary memory (CVE-2018-10911)\\n\\n* glusterfs: remote denial of service of gluster volumes via posix_get_file_contents function in posix-helpers.c (CVE-2018-10914)\\n\\n* glusterfs: Information Exposure in posix_get_file_contents function in posix-helpers.c (CVE-2018-10913)\\n\\nFor more details about the security issue(s), including the impact, a CVSS score, and other related information, refer to the CVE page(s) listed in the References section.\\n\\nRed Hat would like to thank Michael Hanselmann (hansmi.ch) for reporting these issues.\\n\\nAdditional changes :\\n\\nThese updated Red Hat Gluster Storage packages include numerous bug fixes and enhancements. Space precludes documenting all of these changes in this advisory. Users are directed to the Red Hat Gluster Storage 3.4 Release Notes for information on the most significant of these changes :\\n\\nhttps://access.redhat.com/documentation/en-us/red_hat_gluster_storage/ 3.4/html/ 3.4_release_notes/\\n\\nAll users of Red Hat Gluster Storage are advised to upgrade to these updated packages, which provide numerous bug fixes and enhancements.\\n\\nDisabled on 2018/11/06. Detection of Gluster Storage Server on RHEL 6 is no longer possible due to changes in Gluster package versioning.", "cvss3_base_score": "8.8", "see_also": "http://www.nessus.org/u?69f9b995\\nhttp://rhn.redhat.com/errata/RHSA-2018-2608.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10904.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10907.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10911.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10913.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10914.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10923.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10926.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10927.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10928.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10929.html\\nhttps://www.redhat.com/security/data/cve/CVE-2018-10930.html", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "published_date": "", "solution": "n/a.", "script_name": "RHEL 6 : Gluster Storage (RHSA-2018:2608) (deprecated)", "synopsis": "This plugin has been deprecated.", "risk_factor": "Medium", "script_family": "Red Hat Local Security Checks", "script_id": "117318", "cves": ["CVE-2018-10904", "CVE-2018-10907", "CVE-2018-10911", "CVE-2018-10913", "CVE-2018-10914", "CVE-2018-10923", "CVE-2018-10926", "CVE-2018-10927", "CVE-2018-10928", "CVE-2018-10929", "CVE-2018-10930"]}',
 '{"description": "The remote host is missing AIX PTF U823851 which is related to the security of the package bos.cifs_fs.rte\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 610000 : U823851", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "39029", "cves": ""}',
 '{"description": "SunOS 5.10: p7zip patch.\\nDate this patch was last updated by Sun : Nov/10/16\\n\\nThis plugin has been deprecated and either replaced with individual 137321 patch-revision plugins, or deemed non-security related.", "cvss3_base_score": "", "see_also": "https://getupdates.oracle.com/readme/137321-04", "cvss3_vector": "", "published_date": "", "solution": "n/a", "script_name": "Solaris 10 (sparc) : 137321-04 (deprecated)", "synopsis": "This plugin has been deprecated.", "risk_factor": "High", "script_family": "Solaris Local Security Checks", "script_id": "58842", "cves": ""}',
 '{"description": "The remote host is missing AIX PTF U831336 which is related to the security of the package bos.sysmgt.serv_aid\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 610001 : U831336", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "45902", "cves": ""}',
 '{"description": "The remote host is affected by the vulnerability described in GLSA-201401-16 (CCID: Arbitrary code execution)\\n\\n    CCID contains an integer overflow vulnerability in ccid_serial.c.\\n  Impact :\\n\\n    A physically proximate attacker could execute arbitrary code via a smart       card with a specially crafted       serial number.\\n  Workaround :\\n\\n    There is no known workaround at this time.", "cvss3_base_score": "", "see_also": "https://security.gentoo.org/glsa/201401-16", "cvss3_vector": "", "published_date": "", "solution": "All CCID users should upgrade to the latest version:\\n      # emerge --sync       # emerge --ask --oneshot --verbose \'>=app-crypt/ccid-1.4.1-r1\'     NOTE: This is a legacy GLSA. Updates for all affected architectures are       available since January 21, 2011. It is likely that your system is       already no longer affected by this issue.", "script_name": "GLSA-201401-16 : CCID: Arbitrary code execution", "synopsis": "The remote Gentoo host is missing one or more security-related patches.", "risk_factor": "Medium", "script_family": "Gentoo Local Security Checks", "script_id": "72071", "cves": "CVE-2010-4530"}',
 '{"description": "JavaScript is enabled in Adobe Reader. \\n\\nNote that Nessus can only check the SIDs of logged on users, and thus the results may be incomplete.", "cvss3_base_score": "", "see_also": "http://www.nessus.org/u?f30673d6", "cvss3_vector": "", "published_date": "", "solution": "Disable JavaScript in Adobe Reader unless it is needed.", "script_name": "JavaScript Enabled in Adobe Reader", "synopsis": "The remote Windows host has JavaScript enabled in Adobe Reader.", "risk_factor": "None", "script_family": "Windows", "script_id": "66542", "cves": ""}',
 '{"description": "Several flaws were found in the processing of malformed web content. A web page containing malicious content could cause Firefox to terminate unexpectedly or, potentially, execute arbitrary code with the privileges of the user running Firefox. (CVE-2013-5590, CVE-2013-5597, CVE-2013-5599, CVE-2013-5600, CVE-2013-5601, CVE-2013-5602)\\n\\nIt was found that the Firefox JavaScript engine incorrectly allocated memory for certain functions. An attacker could combine this flaw with other vulnerabilities to execute arbitrary code with the privileges of the user running Firefox. (CVE-2013-5595)\\n\\nA flaw was found in the way Firefox handled certain Extensible Stylesheet Language Transformations (XSLT) files. An attacker could combine this flaw with other vulnerabilities to execute arbitrary code with the privileges of the user running Firefox. (CVE-2013-5604)\\n\\nAfter installing the update, Firefox must be restarted for the changes to take effect.", "cvss3_base_score": "", "see_also": "http://www.nessus.org/u?1869bdd7", "cvss3_vector": "", "published_date": "", "solution": "Update the affected packages.", "script_name": "Scientific Linux Security Update : firefox on SL5.x, SL6.x i386/x86_64", "synopsis": "The remote Scientific Linux host is missing one or more security updates.", "risk_factor": "Critical", "script_family": "Scientific Linux Local Security Checks", "script_id": "70704", "cves": ["CVE-2013-5590", "CVE-2013-5595", "CVE-2013-5597", "CVE-2013-5599", "CVE-2013-5600", "CVE-2013-5601", "CVE-2013-5602", "CVE-2013-5604"]}',
 '{"description": "To perform a full credentialed scan, Nessus needs the ability to connect to the remote administrative shares (C$ and ADMIN$). If the shares are not available on the network, this plugin will attempt to enable them for the duration of the scan.\\n\\nYou need to explicitly enable this option for this plugin to work:\\n\\n  \'Enable administrative shares during the scan\'\\n\\n This option can be found under the following section:\\n\\n Scan Configuration > Credentials > Windows > Global Settings.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "n/a", "script_name": "SMB : Disable the C$ and ADMIN$ shares after the scan (WMI)", "synopsis": "The ADMIN$ and/or $C shares have been disabled after the scan.", "risk_factor": "None", "script_family": "Settings", "script_id": "55438", "cves": ""}',
 '{"description": "Several vulnerabilities have been discovered in the MySQL database server. The Common Vulnerabilities and Exposures project identifies the following problems :\\n\\n  - CVE-2010-3677     It was discovered that MySQL allows remote authenticated     users to cause a denial of service (mysqld daemon crash)     via a join query that uses a table with a unique SET     column.\\n\\n  - CVE-2010-3680     It was discovered that MySQL allows remote authenticated     users to cause a denial of service (mysqld daemon crash)     by creating temporary tables while using InnoDB, which     triggers an assertion failure.\\n\\n  - CVE-2010-3681     It was discovered that MySQL allows remote authenticated     users to cause a denial of service (mysqld daemon crash)     by using the HANDLER interface and performing \'alternate     reads from two indexes on a table,\' which triggers an     assertion failure.\\n\\n  - CVE-2010-3682     It was discovered that MySQL incorrectly handled use of     EXPLAIN with certain queries. An authenticated user     could crash the server.\\n\\n  - CVE-2010-3833     It was discovered that MySQL incorrectly handled     propagation during evaluation of arguments to     extreme-value functions. An authenticated user could     crash the server.\\n\\n  - CVE-2010-3834     It was discovered that MySQL incorrectly handled     materializing a derived table that required a temporary     table for grouping. An authenticated user could crash     the server.\\n\\n  - CVE-2010-3835     It was discovered that MySQL incorrectly handled certain     user-variable assignment expressions that are evaluated     in a logical expression context. An authenticated user     could crash the server.\\n\\n  - CVE-2010-3836     It was discovered that MySQL incorrectly handled     pre-evaluation of LIKE predicates during view     preparation. An authenticated user could crash the     server.\\n\\n  - CVE-2010-3837     It was discovered that MySQL incorrectly handled using     GROUP_CONCAT() and WITH ROLLUP together. An     authenticated user could crash the server.\\n\\n  - CVE-2010-3838     It was discovered that MySQL incorrectly handled certain     queries using a mixed list of numeric and LONGBLOB     arguments to the GREATEST() or LEAST() functions. An     authenticated user could crash the server.\\n\\n  - CVE-2010-3840     It was discovered that MySQL incorrectly handled     improper WKB data passed to the PolyFromWKB() function.\\n    An authenticated user could crash the server.", "cvss3_base_score": "", "see_also": "https://security-tracker.debian.org/tracker/CVE-2010-3677\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3680\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3681\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3682\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3833\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3834\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3835\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3836\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3837\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3838\\nhttps://security-tracker.debian.org/tracker/CVE-2010-3840\\nhttps://www.debian.org/security/2011/dsa-2143", "cvss3_vector": "", "published_date": "", "solution": "Upgrade the mysql-dfsg-5.0 packages.\\n\\nFor the stable distribution (lenny), these problems have been fixed in version 5.0.51a-24+lenny5.", "script_name": "Debian DSA-2143-1 : mysql-dfsg-5.0 - several vulnerabilities", "synopsis": "The remote Debian host is missing a security-related update.", "risk_factor": "Medium", "script_family": "Debian Local Security Checks", "script_id": "51530", "cves": ["CVE-2010-3677", "CVE-2010-3680", "CVE-2010-3681", "CVE-2010-3682", "CVE-2010-3833", "CVE-2010-3834", "CVE-2010-3835", "CVE-2010-3836", "CVE-2010-3837", "CVE-2010-3838", "CVE-2010-3840"]}',
 '{"description": "It is possible to write on the root directory of the remote anonymous FTP server. This allows an attacker to upload arbitrary files which can be used in other attacks, or to turn the FTP server into a software distribution point.", "cvss3_base_score": "9.8", "see_also": "", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "published_date": "1997/10/08", "solution": "Restrict write access to the root directory.", "script_name": "Anonymous FTP Writable root Directory", "synopsis": "The remote FTP server allows write access to the root directory.", "risk_factor": "Critical", "script_family": "FTP", "script_id": "10088", "cves": "CVE-1999-0527"}',
 '{"description": "The remote host is missing AIX PTF U813295 which is related to the security of the package bos.net.nfs.cachefs\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 610000 : U813295", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "32587", "cves": ""}',
 '{"description": "A buffer overflow was discovered in libgd2\'s font renderer. By tricking an application using libgd2 into rendering a specially crafted string with a JIS encoded font, a remote attacker could read heap memory or crash the application, leading to a denial of service.\\n(CVE-2007-0455)\\n\\nXavier Roche discovered that libgd2 did not correctly validate PNG callback results. If an application were tricked into processing a specially crafted PNG image, it would monopolize CPU resources. Since libgd2 is often used in PHP and Perl web applications, this could lead to a remote denial of service. (CVE-2007-2756).\\n\\nNote that Tenable Network Security has extracted the preceding description block directly from the Ubuntu security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues.", "cvss3_base_score": "", "see_also": "https://usn.ubuntu.com/473-1/", "cvss3_vector": "", "published_date": "", "solution": "Update the affected packages.", "script_name": "Ubuntu 6.06 LTS / 6.10 / 7.04 : libgd2 vulnerabilities (USN-473-1)", "synopsis": "The remote Ubuntu host is missing one or more security-related patches.", "risk_factor": "High", "script_family": "Ubuntu Local Security Checks", "script_id": "28074", "cves": ["CVE-2007-0455", "CVE-2007-2756"]}',
 '{"description": "Updated pam packages that fix two security issues, several bugs, and add various enhancements are now available for Red Hat Enterprise Linux 6.\\n\\nThe Red Hat Security Response Team has rated this update as having moderate security impact. Common Vulnerability Scoring System (CVSS) base scores, which give detailed severity ratings, are available for each vulnerability from the CVE links in the References section.\\n\\nPluggable Authentication Modules (PAM) provide a system whereby administrators can set up authentication policies without having to recompile programs to handle authentication.\\n\\nA stack-based buffer overflow flaw was found in the way the pam_env module parsed users\' \'~/.pam_environment\' files. If an application\'s PAM configuration contained \'user_readenv=1\' (this is not the default), a local attacker could use this flaw to crash the application or, possibly, escalate their privileges. (CVE-2011-3148)\\n\\nA denial of service flaw was found in the way the pam_env module expanded certain environment variables. If an application\'s PAM configuration contained \'user_readenv=1\' (this is not the default), a local attacker could use this flaw to cause the application to enter an infinite loop. (CVE-2011-3149)\\n\\nRed Hat would like to thank Kees Cook of the Google ChromeOS Team for reporting the CVE-2011-3148 and CVE-2011-3149 issues.\\n\\nThese updated pam packages include numerous bug fixes and enhancements. Space precludes documenting all of these changes in this advisory. Users are directed to the Red Hat Enterprise Linux 6.4 Technical Notes, linked to in the References, for information on the most significant of these changes.\\n\\nAll pam users are advised to upgrade to these updated packages, which contain backported patches to correct these issues and add these enhancements.", "cvss3_base_score": "", "see_also": "http://www.nessus.org/u?a66dcc2d\\nhttp://www.nessus.org/u?c91523f5", "cvss3_vector": "", "published_date": "", "solution": "Update the affected pam packages.", "script_name": "CentOS 6 : pam (CESA-2013:0521)", "synopsis": "The remote CentOS host is missing one or more security updates.", "risk_factor": "Medium", "script_family": "CentOS Local Security Checks", "script_id": "65152", "cves": ["CVE-2011-3148", "CVE-2011-3149"]}',
 '{"description": "It was discovered that LibRaw incorrectly handled certain files. An attacker could possibly use this to execute arbitrary code.\\n(CVE-2018-10528)\\n\\nIt was discovered that LibRaw incorrectly handled certain files. An attacker could possibly use this to obtain sensitive information.\\n(CVE-2018-10529).\\n\\nNote that Tenable Network Security has extracted the preceding description block directly from the Ubuntu security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues.", "cvss3_base_score": "8.8", "see_also": "https://usn.ubuntu.com/3639-1/", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "published_date": "", "solution": "Update the affected libraw15 and / or libraw16 packages.", "script_name": "Ubuntu 16.04 LTS / 17.10 / 18.04 LTS : libraw vulnerabilities (USN-3639-1)", "synopsis": "The remote Ubuntu host is missing one or more security-related patches.", "risk_factor": "Medium", "script_family": "Ubuntu Local Security Checks", "script_id": "109648", "cves": ["CVE-2018-10528", "CVE-2018-10529"]}',
 '{"description": "The remote host is affected by the vulnerability described in GLSA-200412-03 (imlib: Buffer overflows in image decoding)\\n\\n    Pavel Kankovsky discovered that several overflows found in the     libXpm library (see GLSA 200409-34) also applied to imlib. He also     fixed a number of other potential flaws.\\n  Impact :\\n\\n    A remote attacker could entice a user to view a carefully-crafted     image file, which would potentially lead to execution of arbitrary code     with the rights of the user viewing the image. This affects any program     that makes use of the imlib library.\\n  Workaround :\\n\\n    There is no known workaround at this time.", "cvss3_base_score": "", "see_also": "https://security.gentoo.org/glsa/200409-34\\nhttps://security.gentoo.org/glsa/200412-03", "cvss3_vector": "", "published_date": "", "solution": "All imlib users should upgrade to the latest version:\\n    # emerge --sync     # emerge --ask --oneshot --verbose \'>=media-libs/imlib-1.9.14-r3\'", "script_name": "GLSA-200412-03 : imlib: Buffer overflows in image decoding", "synopsis": "The remote Gentoo host is missing one or more security-related patches.", "risk_factor": "Critical", "script_family": "Gentoo Local Security Checks", "script_id": "15913", "cves": "CVE-2004-1026"}',
 '{"description": "Upstream bugfix. CVE-2018-18898\\n\\nNote that Tenable Network Security has extracted the preceding description block directly from the Fedora update system website.\\nTenable has attempted to automatically clean and format it as much as possible without introducing additional issues.", "cvss3_base_score": "7.5", "see_also": "https://bodhi.fedoraproject.org/updates/FEDORA-2019-73cbc02e14", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "published_date": "2019/03/21", "solution": "Update the affected perl-Email-Address-List package.", "script_name": "Fedora 29 : perl-Email-Address-List (2019-73cbc02e14)", "synopsis": "The remote Fedora host is missing a security update.", "risk_factor": "Medium", "script_family": "Fedora Local Security Checks", "script_id": "122135", "cves": "CVE-2018-18898"}',
 '{"description": "This update for xen fixes the following issues :\\n\\n  - CVE-2017-12855: Premature clearing of GTF_writing /     GTF_reading lead to potentially leaking sensitive     information (XSA-230, bsc#1052686).\\n\\n  - CVE-2017-12135: Unbounded recursion in grant table code     allowed a malicious guest to crash the host or     potentially escalate privileges/leak information     (XSA-226, bsc#1051787).\\n\\n  - CVE-2017-12137: Incorrectly-aligned updates to     pagetables allowed for privilege escalation (XSA-227,     bsc#1051788).\\n\\n  - CVE-2017-11334: The address_space_write_continue     function in exec.c allowed local guest OS privileged     users to cause a denial of service (out-of-bounds access     and guest instance crash) by leveraging use of     qemu_map_ram_ptr to access guest ram block area     (bsc#1048920).\\n\\n  - CVE-2017-11434: The dhcp_decode function in     slirp/bootp.c allowed local guest OS users to cause a     denial of service (out-of-bounds read) via a crafted     DHCP options string (bsc#1049578).\\n\\n  - CVE-2017-10664: qemu-nbd did not ignore SIGPIPE, which     allowed remote attackers to cause a denial of service     (daemon crash) by disconnecting during a     server-to-client reply attempt (bsc#1046637).\\n\\nNote that Tenable Network Security has extracted the preceding description block directly from the SUSE security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues.", "cvss3_base_score": "8.8", "see_also": "https://bugzilla.suse.com/show_bug.cgi?id=1046637\\nhttps://bugzilla.suse.com/show_bug.cgi?id=1048920\\nhttps://bugzilla.suse.com/show_bug.cgi?id=1049578\\nhttps://bugzilla.suse.com/show_bug.cgi?id=1051787\\nhttps://bugzilla.suse.com/show_bug.cgi?id=1051788\\nhttps://bugzilla.suse.com/show_bug.cgi?id=1052686\\nhttps://www.suse.com/security/cve/CVE-2017-10664/\\nhttps://www.suse.com/security/cve/CVE-2017-11334/\\nhttps://www.suse.com/security/cve/CVE-2017-11434/\\nhttps://www.suse.com/security/cve/CVE-2017-12135/\\nhttps://www.suse.com/security/cve/CVE-2017-12137/\\nhttps://www.suse.com/security/cve/CVE-2017-12855/\\nhttp://www.nessus.org/u?9990d583", "cvss3_vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "published_date": "", "solution": "To install this SUSE Security Update use YaST online_update.\\nAlternatively you can run the command listed for your product :\\n\\nSUSE Linux Enterprise Server 11-SP3-LTSS:zypper in -t patch slessp3-xen-13259=1\\n\\nSUSE Linux Enterprise Point of Sale 11-SP3:zypper in -t patch sleposp3-xen-13259=1\\n\\nSUSE Linux Enterprise Debuginfo 11-SP3:zypper in -t patch dbgsp3-xen-13259=1\\n\\nTo bring your system up-to-date, use \'zypper patch\'.", "script_name": "SUSE SLES11 Security Update : xen (SUSE-SU-2017:2339-1)", "synopsis": "The remote SUSE host is missing one or more security updates.", "risk_factor": "High", "script_family": "SuSE Local Security Checks", "script_id": "102954", "cves": ["CVE-2017-10664", "CVE-2017-11334", "CVE-2017-11434", "CVE-2017-12135", "CVE-2017-12137", "CVE-2017-12855"]}',
 '{"description": "The version of Opera installed on the remote host is earlier than 9.64 and thus reportedly affected by multiple issues :\\n\\n  - A memory-corruption vulnerability when processing specially     crafted JPEG files could allow an attacker to execute arbitrary     code with the privileges of the affected application. (926)   \\n  - It may be possible for certain plugins to execute arbitrary code     in the context of a different domain. An attacker could exploit     this to steal authentication credentials as well as carry out     other attacks.", "cvss3_base_score": "", "see_also": "http://web.archive.org/web/20170921133116/http://www.opera.com/docs/changelogs/windows/964/\\nhttp://web.archive.org/web/20130225221001/http://www.opera.com/support/kb/view/926/", "cvss3_vector": "", "published_date": "", "solution": "Upgrade to Opera 9.64 or later.", "script_name": "Opera < 9.64 Multiple Vulnerabilities", "synopsis": "The remote host contains a web browser that is affected by multiple issues.", "risk_factor": "High", "script_family": "Windows", "script_id": "35761", "cves": ["CVE-2009-0914", "CVE-2009-0915", "CVE-2009-0916"]}',
 '{"description": "From Red Hat Security Advisory 2008:0908 :\\n\\nUpdated thunderbird packages that fix several security issues are now available for Red Hat Enterprise Linux 4 and 5.\\n\\nThis update has been rated as having moderate security impact by the Red Hat Security Response Team.\\n\\nMozilla Thunderbird is a standalone mail and newsgroup client.\\n\\nSeveral flaws were found in the processing of malformed HTML mail content. An HTML mail message containing malicious content could cause Thunderbird to crash or, potentially, execute arbitrary code as the user running Thunderbird. (CVE-2008-0016, CVE-2008-4058, CVE-2008-4059, CVE-2008-4060, CVE-2008-4061, CVE-2008-4062)\\n\\nSeveral flaws were found in the way malformed HTML mail content was displayed. An HTML mail message containing specially crafted content could potentially trick a Thunderbird user into surrendering sensitive information. (CVE-2008-3835, CVE-2008-4067, CVE-2008-4068)\\n\\nA flaw was found in Thunderbird that caused certain characters to be stripped from JavaScript code. This flaw could allow malicious JavaScript to bypass or evade script filters. (CVE-2008-4065, CVE-2008-4066)\\n\\nNote: JavaScript support is disabled by default in Thunderbird; the above issue is not exploitable unless JavaScript is enabled.\\n\\nA heap based buffer overflow flaw was found in the handling of cancelled newsgroup messages. If the user cancels a specially crafted newsgroup message it could cause Thunderbird to crash or, potentially, execute arbitrary code as the user running Thunderbird.\\n(CVE-2008-4070)\\n\\nAll Thunderbird users should upgrade to these updated packages, which resolve these issues.", "cvss3_base_score": "", "see_also": "https://oss.oracle.com/pipermail/el-errata/2008-October/000748.html", "cvss3_vector": "", "published_date": "", "solution": "Update the affected thunderbird package.", "script_name": "Oracle Linux 4 : thunderbird (ELSA-2008-0908)", "synopsis": "The remote Oracle Linux host is missing a security update.", "risk_factor": "Critical", "script_family": "Oracle Linux Local Security Checks", "script_id": "67754", "cves": ["CVE-2008-0016", "CVE-2008-3835", "CVE-2008-4058", "CVE-2008-4059", "CVE-2008-4060", "CVE-2008-4061", "CVE-2008-4062", "CVE-2008-4065", "CVE-2008-4066", "CVE-2008-4067", "CVE-2008-4068", "CVE-2008-4070"]}',
 '{"description": "The remote host is missing AIX PTF U825048 which is related to the security of the package bos.acct\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 530007 : U825048", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "39643", "cves": ""}',
 '{"description": "Julien Cayzac discovered that under certain circumstances lighttpd, a fast webserver with minimal memory footprint, might allow the reading of arbitrary files from the system. This problem could only occur with a non-standard configuration.", "cvss3_base_score": "", "see_also": "https://www.debian.org/security/2008/dsa-1521", "cvss3_vector": "", "published_date": "", "solution": "Upgrade the lighttpd package.\\n\\nFor the stable distribution (etch), this problem has been fixed in version 1.4.13-4etch6.", "script_name": "Debian DSA-1521-1 : lighttpd - file disclosure", "synopsis": "The remote Debian host is missing a security-related update.", "risk_factor": "Medium", "script_family": "Debian Local Security Checks", "script_id": "31592", "cves": "CVE-2008-1270"}',
 '{"description": "It was discovered that Twisted incorrectly handled certain HTTP requests. An attacker could possibly use this issue to execute arbitrary code.\\n\\nNote that Tenable Network Security has extracted the preceding description block directly from the Ubuntu security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues.", "cvss3_base_score": "", "see_also": "https://usn.ubuntu.com/3585-1/", "cvss3_vector": "", "published_date": "", "solution": "Update the affected packages.", "script_name": "Ubuntu 14.04 LTS / 16.04 LTS : twisted vulnerability (USN-3585-1)", "synopsis": "The remote Ubuntu host is missing one or more security-related patches.", "risk_factor": "High", "script_family": "Ubuntu Local Security Checks", "script_id": "107146", "cves": "CVE-2016-1000111"}',
 '{"description": "Updated CUPS packages that fix a security issue in the Internet Printing Protocol (IPP) handling and correct some bugs are now available for Red Hat Enterprise Linux 5.\\n\\nThis update has been rated as having important security impact by the Red Hat Security Response Team.\\n\\nThe Common UNIX Printing System (CUPS) provides a portable printing layer for UNIX(R) operating systems.\\n\\nA flaw was found in the way CUPS handles certain Internet Printing Protocol (IPP) tags. A remote attacker who is able to connect to the IPP TCP port could send a malicious request causing the CUPS daemon to crash, or potentially execute arbitrary code. Please note that the default CUPS configuration does not allow remote hosts to connect to the IPP TCP port. (CVE-2007-4351)\\n\\nRed Hat would like to thank Alin Rad Pop for reporting this issue.\\n\\nAll CUPS users are advised to upgrade to these updated packages, which contain a backported patch to resolve this issue.\\n\\nIn addition, the following bugs were fixed :\\n\\n* the CUPS service has been changed to start after sshd, to avoid causing delays when logging in when the system is booted.\\n\\n* the logrotate settings have been adjusted so they do not cause CUPS to reload its configuration. This is to avoid re-printing the current job, which could occur when it was a long-running job.\\n\\n* a bug has been fixed in the handling of the If-Modified-Since: HTTP header.\\n\\n* in the LSPP configuration, labels for labeled jobs did not line-wrap. This has been fixed.\\n\\n* an access check in the LSPP configuration has been made more secure.\\n\\n* the cups-lpd service no longer ignores the \'-odocument-format=...\' option.\\n\\n* a memory allocation bug has been fixed in cupsd.\\n\\n* support for UNIX domain sockets authentication without passwords has been added.\\n\\n* in the LSPP configuration, a problem that could lead to cupsd crashing has been fixed.\\n\\n* the error handling in the initscript has been improved.\\n\\n* The job-originating-host-name attribute was not correctly set for jobs submitted via the cups-lpd service. This has been fixed.\\n\\n* a problem with parsing IPv6 addresses in the configuration file has been fixed.\\n\\n* a problem that could lead to cupsd crashing when it failed to open a \'file:\' URI has been fixed.", "cvss3_base_score": "", "see_also": "http://www.nessus.org/u?cf2c9024\\nhttp://www.nessus.org/u?076433e3", "cvss3_vector": "", "published_date": "", "solution": "Update the affected cups packages.", "script_name": "CentOS 5 : cups (CESA-2007:1020)", "synopsis": "The remote CentOS host is missing one or more security updates.", "risk_factor": "Critical", "script_family": "CentOS Local Security Checks", "script_id": "43660", "cves": "CVE-2007-4351"}',
 '{"description": "A cross-site scripting (XSS) vulnerability exists intmui/dashboard/echo.jsp for the BIG-IP Configuration utility and the Enterprise Manager Configuration utility.", "cvss3_base_score": "", "see_also": "https://support.f5.com/csp/article/K15532", "cvss3_vector": "", "published_date": "", "solution": "Upgrade to one of the non-vulnerable versions listed in the F5 Solution SOL15532.", "script_name": "F5 Networks BIG-IP : XSS vulnerability in echo.jsp (SOL15532)", "synopsis": "The remote device is missing a vendor-supplied security patch.", "risk_factor": "Medium", "script_family": "F5 Networks Local Security Checks", "script_id": "78191", "cves": "CVE-2014-4023"}',
 '{"description": "According to its version number, the WordPress application running on the remote web server is prior to 4.3.1. It is, therefore, potentially affected by multiple vulnerabilities :\\n\\n  - A cross-site scripting vulnerability exists when     processing shortcode tags due to improper validation of     user-supplied input. An attacker can exploit this, via a     specially crafted request, to execute arbitrary script     code in a user\'s browser session. (CVE-2015-5714)\\n\\n  - An unspecified vulnerability exists that allows an     authenticated attacker to publish private posts and make     them \'sticky\'. (CVE-2015-5715)\\n\\n  - An unspecified cross-site scripting vulnerability exists     in the user list table. An attacker can exploit this,     via a specially crafted request, to execute arbitrary     script code in a user\'s browser session.\\n\\nNote that Nessus has not tested for these issues but has instead relied only on the application\'s self-reported version number.", "cvss3_base_score": "", "see_also": "https://codex.wordpress.org/Version_4.3.1\\nhttps://wordpress.org/news/2015/09/wordpress-4-3-1/\\nhttp://www.nessus.org/u?6d060592", "cvss3_vector": "", "published_date": "2015/09/15", "solution": "Upgrade to WordPress 4.3.1 or later.", "script_name": "WordPress < 4.3.1 Multiple Vulnerabilities", "synopsis": "The PHP application running on the remote web server is affected by multiple vulnerabilities.", "risk_factor": "Medium", "script_family": "CGI abuses", "script_id": "85985", "cves": ["CVE-2015-5714", "CVE-2015-5715", "CVE-2015-7989"]}',
 '{"description": "update to 1.9.13, fix for CVE-2017-7233\\n\\nNote that Tenable Network Security has extracted the preceding description block directly from the Fedora update system website.\\nTenable has attempted to automatically clean and format it as much as possible without introducing additional issues.", "cvss3_base_score": "6.1", "see_also": "https://bodhi.fedoraproject.org/updates/FEDORA-2017-c0ef6054d7", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "published_date": "", "solution": "Update the affected python-django package.", "script_name": "Fedora 25 : python-django (2017-c0ef6054d7)", "synopsis": "The remote Fedora host is missing a security update.", "risk_factor": "Medium", "script_family": "Fedora Local Security Checks", "script_id": "99613", "cves": "CVE-2017-7233"}',
 '{"description": "Several security issues have been corrected in multiple demuxers and decoders of the libav multimedia library. A full list of the changes is available at https://git.libav.org/?p=libav.git;a=blob;f=Changelog;hb=refs/tags/v11 .8", "cvss3_base_score": "5.5", "see_also": "http://www.nessus.org/u?4ed9920b\\nhttps://packages.debian.org/source/jessie/libav\\nhttps://www.debian.org/security/2016/dsa-3685", "cvss3_vector": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H", "published_date": "", "solution": "Upgrade the libav packages.\\n\\nFor the stable distribution (jessie), these problems have been fixed in version 6:11.8-1~deb8u1.", "script_name": "Debian DSA-3685-1 : libav - security update", "synopsis": "The remote Debian host is missing a security-related update.", "risk_factor": "Medium", "script_family": "Debian Local Security Checks", "script_id": "93848", "cves": "CVE-2016-7424"}',
 '{"description": "The remote host is affected by the vulnerability described in GLSA-200409-25 (CUPS: Denial of service vulnerability)\\n\\n    Alvaro Martinez Echevarria discovered a hole in the CUPS Internet Printing     Protocol (IPP) implementation that allows remote attackers to cause CUPS to     stop listening on the IPP port.\\n  Impact :\\n\\n    A remote user with malicious intent can easily cause a denial of service to     the CUPS daemon by sending a specially crafted UDP datagram packet to the     IPP port.\\n  Workaround :\\n\\n    There is no known workaround at this time.", "cvss3_base_score": "", "see_also": "https://github.com/apple/cups/issues/863\\nhttps://security.gentoo.org/glsa/200409-25", "cvss3_vector": "", "published_date": "", "solution": "All CUPS users should upgrade to the latest version:\\n    # emerge sync     # emerge -pv \'>=net-print/cups-1.1.20-r2\'     # emerge \'>=net-print/cups-1.1.20-r2\'", "script_name": "GLSA-200409-25 : CUPS: Denial of service vulnerability", "synopsis": "The remote Gentoo host is missing one or more security-related patches.", "risk_factor": "Medium", "script_family": "Gentoo Local Security Checks", "script_id": "14780", "cves": "CVE-2004-0558"}',
 '{"description": "The remote host is missing AIX PTF U836927 which is related to the security of the package bos.pmapi.pmsvcs\\n\\nYou should install this PTF for your system to be up-to-date.", "cvss3_base_score": "", "see_also": "", "cvss3_vector": "", "published_date": "", "solution": "Run \'suma -x -a RqType=Security\' on the remote system", "script_name": "AIX 610003 : U836927", "synopsis": "The remote host is missing a vendor supplied security patch", "risk_factor": "High", "script_family": "AIX Local Security Checks", "script_id": "48706", "cves": ""}',
 '{"description": "The transaction id and the udp source port used for DNS queries by the bind nameserver were predictable. Attackers could potentially exploit that weakness to manipulate the DNS cache (\'DNS cache poisoning\', CVE-2008-1447).\\n\\nAdditionally the root.hint zone file was updated to contain the new IP number of the \'L\' root DNS server.", "cvss3_base_score": "", "see_also": "http://support.novell.com/security/cve/CVE-2008-1447.html", "cvss3_vector": "", "published_date": "", "solution": "Apply YOU patch number 12197.", "script_name": "SuSE9 Security Update : bind (YOU Patch Number 12197)", "synopsis": "The remote SuSE 9 host is missing a security-related patch.", "risk_factor": "Medium", "script_family": "SuSE Local Security Checks", "script_id": "41221", "cves": "CVE-2008-1447"}',
 '{"description": "This update for gd fixes the following security issues :\\n\\n  - CVE-2016-7568: A specially crafted image file could     cause an application crash or potentially execute     arbitrary code when the image is converted to webp     (bsc#1001900)\\n\\n  - CVE-2016-8670: Stack Buffer Overflow in GD dynamicGetbuf     (bsc#1004924)\\n\\n  - CVE-2016-6911: Check for out-of-bound read in     dynamicGetbuf() (bsc#1005274)\\n\\nNote that Tenable Network Security has extracted the preceding description block directly from the SUSE security advisory. Tenable has attempted to automatically clean and format it as much as possible without introducing additional issues.", "cvss3_base_score": "9.8", "see_also": "https://bugzilla.suse.com/show_bug.cgi?id=1001900\\nhttps://bugzilla.suse.com/show_bug.cgi?id=1004924\\nhttps://bugzilla.suse.com/show_bug.cgi?id=1005274\\nhttps://www.suse.com/security/cve/CVE-2016-6911/\\nhttps://www.suse.com/security/cve/CVE-2016-7568/\\nhttps://www.suse.com/security/cve/CVE-2016-8670/\\nhttp://www.nessus.org/u?1b0ce43f", "cvss3_vector": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "published_date": "", "solution": "To install this SUSE Security Update use YaST online_update.\\nAlternatively you can run the command listed for your product :\\n\\nSUSE Linux Enterprise Workstation Extension 12-SP1:zypper in -t patch SUSE-SLE-WE-12-SP1-2016-1571=1\\n\\nSUSE Linux Enterprise Software Development Kit 12-SP1:zypper in -t patch SUSE-SLE-SDK-12-SP1-2016-1571=1\\n\\nSUSE Linux Enterprise Server 12-SP1:zypper in -t patch SUSE-SLE-SERVER-12-SP1-2016-1571=1\\n\\nSUSE Linux Enterprise Desktop 12-SP1:zypper in -t patch SUSE-SLE-DESKTOP-12-SP1-2016-1571=1\\n\\nTo bring your system up-to-date, use \'zypper patch\'.", "script_name": "SUSE SLED12 / SLES12 Security Update : gd (SUSE-SU-2016:2668-1)", "synopsis": "The remote SUSE host is missing one or more security updates.", "risk_factor": "High", "script_family": "SuSE Local Security Checks", "script_id": "94434", "cves": ["CVE-2016-6911", "CVE-2016-7568", "CVE-2016-8670"]}']



import random, time, uuid, json
import pendulum
import pprint


global_severity_counts = 0

def get_scanned_host_ips(host_count=1):
    if host_count < 256:
        ip = [10,10,0,0]
        ip_list = []

        for i in range(host_count):
            ip_list.append("%s.%s.%s.%s" % (ip[0], ip[1], ip[2], ip[3] + i))
    return ip_list

def get_random_severity_counts():
    return {
        "critical": random.randint(0,5),
        "high": random.randint(0,3),
        "medium": random.randint(0,10),
        "low": random.randint(0,10),
        "info": random.randint(0,25)
    }
    
def percentage(part, whole):
    return round(100 * float(part)/float(whole), 2)


def get_hosts_details(ip_address, critical_count,high_count, med_count, low_count, info_count, host_id=1):
    sevTotal = 0
    sevTotal = critical_count + high_count + med_count + low_count + info_count

    score = critical_count * 5
    score += high_count * 4
    score += med_count * 3
    score += low_count * 2
    score += info_count * 1

    numchecksconsidered = random.randint(323, 839)

    return {
            "critical": 0 if critical_count == 0 else percentage(critical_count, numchecksconsidered),
            "high": 0 if high_count == 0 else percentage(high_count, numchecksconsidered),
            "host_id": host_id,
            "host_index": 0,
            "hostname": ip_address,
            "info": 0 if info_count == 0 else percentage(info_count, numchecksconsidered),
            "low": 0 if low_count == 0 else percentage(low_count, numchecksconsidered),
            "medium": 0 if med_count == 0 else percentage(med_count, numchecksconsidered),
            "numchecksconsidered": numchecksconsidered,
            "progress": "465-465/79806-79806",
            "scanprogresscurrent": numchecksconsidered,
            "scanprogresstotal": numchecksconsidered,
            "score": score,
            "severitycount": {
                "item": [
                    {
                        "count": info_count,
                        "severitylevel": 0
                    },
                    {
                        "count": low_count,
                        "severitylevel": 1
                    },
                    {
                        "count": med_count,
                        "severitylevel": 2
                    },
                    {
                        "count": high_count,
                        "severitylevel": 3
                    },
                    {
                        "count": critical_count,
                        "severitylevel": 4
                    }
                ]
            },
            "totalchecksconsidered": numchecksconsidered
        }

#pprint.pprint(get_hosts_details('192.168.0.1'))

def get_random_vulnerabilities(vuln_count=1):
    # This is where i would do this on my local machine but since I can't upload the JSON I have added some random ones above
    random_vulns = random.sample(nessus_plugin_samples, random.randint(1,15))
    return random_vulns
    #vuln_dict = ''
    #with open('/Users/josh.rickard/Desktop/Vulnerability Management Use Case/nessus-plugin-samples.json') as vulnerabilities:
    #    vuln_dict = json.loads(vulnerabilities.read())
    
    #i = 0
    #vuln_list = []
   # print(type(vuln_dict[0]))
    #while i < vuln_count:
        #critical_vulns = vuln_dict['risk_factor']
    #    vuln_list.append(vuln_dict[random.randint(0, len(vuln_dict))])
     #   i += 1
    
    #return vuln_list

#print(get_random_vulnerabilities(vuln_count=5))

def convert_to_epoch_time(timestamp):
    # timestmap format needed
    #date_time = '29.08.2011 11:05:02'
    date_time = '%s.%s.%s %s:%s:%s' % (timestamp.day, timestamp.month, timestamp.year, timestamp.hour, timestamp.minute, timestamp.second)
    pattern = '%d.%m.%Y %H:%M:%S'
    epoch = int(time.mktime(time.strptime(date_time, pattern)))
    return epoch


def get_scan_details(scan_count=1, host_count=1):
    return_list = []
    scan_id = 1
    i = 0

    while i < scan_count:

        scan_start_time = pendulum.now().subtract(days=random.randint(1,30), hours=random.randint(1,23), minutes=random.randint(1,59), seconds=random.randint(1,59))
        scan_end_time = scan_start_time.add(hours=random.randint(1,4), minutes=random.randint(1, 59), seconds=random.randint(1,59))

        ips = get_scanned_host_ips(host_count=host_count)
        ip_string_list = ','.join(ips)
        
        critical_count = 0
        high_count = 0
        med_count = 0
        low_count = 0
        info_count = 0
        vulnerabilities =  get_random_vulnerabilities(random.randint(1, 25))
        for item in vulnerabilities:
            if item['risk_factor'] == 'Critical':
                critical_count += 1
            if item['risk_factor'] == 'High':
                high_count += 1
            if item['risk_factor'] == 'Medium':
                med_count += 1
            if item['risk_factor'] == 'Low':
                low_count += 1
            if item['risk_factor'] == 'Info':
                info_count += 1

        host_details = []
        i = 0
        for ip in ips:
            host_details.append(get_hosts_details(ip, critical_count, high_count, med_count, low_count, info_count, host_id=i))
            i += i

        return_list.append({
            "info": {
                "schedule_uuid": scan_id,
                "edit_allowed": 'true',
                "status": random.choice(['Complete', 'Incomplete', 'Imported', 'Scheduled', 'Running', 'Canceled', 'Paused', 'Stopped']),
                "scan_start": scan_start_time,
                "no_target": 'null',
                "targets": ip_string_list,
                "timestamp": scan_end_time,
                "object_id": scan_id,
                "scanner_name": 'Local Scanner %s' % random.randint(1,5),
                "uuid": str(uuid.uuid4()),
                "scanner_end": scan_end_time,
                "scan_end": scan_end_time,
                "hostcount": len(ips),
                "scan_type": 'local',
                "name": random.choice(['Web Server Scan', 'Endpoint Scan', 'Container Scanner', 'Audit Scan', 'Vulnerability Patch List Scan', 'Random Scan'])
            },
            "hosts": host_details,
            "vulnerabilities": vulnerabilities,
        })
        i += 1

    return return_list


import swimlane
from swimlane import Swimlane

# Credentials stored in the Key Store
password = sw_context.inputs['swimlane_api']


sw = Swimlane('https://sw_web:4443', 'api', password, verify_ssl=False, default_timeout=10)


scans_app = sw.apps.get(name='Vulnerability Management: Scans')
vuln_app = sw.apps.get(name='Vulnerability Management: Vulnerabilities')
hosts_app = sw.apps.get(name='Vulnerability Management: Hosts')

scans_to_generate = 1
hosts_to_generate = random.randint(1,2)

total_scans = get_scan_details(scan_count=scans_to_generate, host_count=hosts_to_generate)

for scan in total_scans:
    new_scan_record = scans_app.records.create(**{
        'scan-id': scan['info']['uuid'],
        'scanner-name': scan['info']['scanner_name'],
        'scan-start-time': scan['info']['scan_start'],
        'scan-end-time': scan['info']['scan_end'],
        'scan-status': scan['info']['status'],
        'host-count': scan['info']['hostcount'],
        'scan-name': scan['info']['name']
    })
    for host in scan['hosts']:
        info_count = 0
        low_count = 0
        med_count = 0
        high_count = 0
        critical_count = 0
        for item in host['severitycount']['item']:
            if item['severitylevel'] == 0:
                info_count = item['count']
            if item['severitylevel'] == 1:
                low_count = item['count']
            if item['severitylevel'] == 2:
                med_count = item['count']
            if item['severitylevel'] == 3:
                high_count = item['count']
            if item['severitylevel'] == 4:
                critical_count = item['count']

        new_host_record = hosts_app.records.create(**{
            'host-ip': host['hostname'],
            'host-id': host['host_id'],
            'number-of-checks-considered': host['numchecksconsidered'],
            'last-scan-date': scan['info']['scan_end'],
            'host-name': host['hostname'],
            'host-vulnerability-score': host['score'],
            'number-of-critical-vulns': critical_count,
            'number-of-high-vulns': high_count,
            'number-of-medium-vulns': med_count,
            'number-of-info-vulns': info_count,
            'number-of-low-vulns': low_count
        })
    
    